<div style="text-align: center; padding: 40px 20px;">
    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ -->
    <div id="redirect-message" style="margin-bottom: 30px;">
      <h3 style="color: #333; margin-bottom: 15px;">üéâ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h3>
      <p style="color: #666; font-size: 16px; line-height: 1.5;">
        –í—ã –±—É–¥–µ—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã –≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤–∑–Ω–æ—Å–∞...
      </p>
    </div>
  
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="auto-payment-loading">
      <div style="color: #667eea; font-size: 16px; margin-bottom: 20px;">
        ‚è≥ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã...
      </div>
      <div style="width: 50px; height: 50px; border: 4px solid #f3f3f3; border-top: 4px solid #667eea; border-radius: 50%; margin: 0 auto; animation: spin 1s linear infinite;"></div>
    </div>
  
    <!-- –†–µ–∑–µ—Ä–≤–Ω–∞—è —Å—Å—ã–ª–∫–∞ -->
    <div id="manual-redirect" style="display: none; margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
      <p style="color: #666; margin-bottom: 15px;">–ï—Å–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ:</p>
      <a id="payment-link" href="#" style="background: #667eea; color: white; padding: 12px 25px; text-decoration: none; border-radius: 25px; font-weight: bold; display: inline-block;">
        üí≥ –ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ
      </a>
    </div>
  
    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ -->
    <div id="auto-payment-error" style="display: none; background: #ffe6e6; color: #d63031; padding: 15px; border-radius: 5px; margin: 20px 0;"></div>
  </div>
  
  <style>
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  
  #payment-link:hover {
    background: #5a6fd8 !important;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
  }
  </style>
  
  <script>
  // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
  const AUTO_PAYMENT_CONFIG = {
    SERVER_URL: 'https://p7402kx7-3000.euw.devtunnels.ms/init-payment', // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à URL —Å–µ—Ä–≤–µ—Ä–∞
    MEMBERSHIP_FEE: '10', // –°—É–º–º–∞ –≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤–∑–Ω–æ—Å–∞
    REDIRECT_DELAY: 2000 // –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –ø—Ä–æ—Ü–µ—Å—Å–∞ (2 —Å–µ–∫—É–Ω–¥—ã)
  };
  
  // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–ø–ª–∞—Ç—ã
  async function initAutoPayment() {
    try {
      console.log('üöÄ –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–ø–ª–∞—Ç—ã...');
  
      // –ü–æ–ª—É—á–∞–µ–º email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      const userEmail = getAutoPaymentEmail();
      
      if (!userEmail) {
        throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å email –¥–ª—è –æ–ø–ª–∞—Ç—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π.');
      }
  
      console.log('üìß –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–ø–ª–∞—Ç—ã –¥–ª—è:', userEmail);
  
      // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–ª–∞—Ç–µ–∂–∞
      const paymentData = {
        formid: 'bf403',
        projectid: window.tilda_projectid || 'your_project_id',
        formname: '–í—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å –≤ –∫–ª—É–±',
        Price: AUTO_PAYMENT_CONFIG.MEMBERSHIP_FEE,
        Email: userEmail,
        Phone: '',
        Name: ''
      };
  
      // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
      const response = await fetch(AUTO_PAYMENT_CONFIG.SERVER_URL, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(paymentData)
      });
  
      const result = await response.json();
      console.log('‚úÖ –û—Ç–≤–µ—Ç –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã:', result);
  
      if (result.success && result.paymentURL) {
        // –£—Å–ø–µ—à–Ω–æ - –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã
        console.log('üîó –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞:', result.paymentURL);
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —É—Å–ø–µ—à–Ω–æ–º –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏
        document.getElementById('redirect-message').innerHTML = `
          <h3 style="color: #27ae60; margin-bottom: 15px;">‚úÖ –ü–ª–∞—Ç–µ–∂–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≥–æ—Ç–æ–≤–∞!</h3>
          <p style="color: #666; font-size: 16px;">–ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã...</p>
        `;
        
        // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã
        setTimeout(() => {
          window.location.href = result.paymentURL;
        }, 1000);
        
      } else {
        throw new Error(result.error || '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç–µ–∂');
      }
  
    } catch (error) {
      console.error('‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–ø–ª–∞—Ç—ã:', error);
      showAutoPaymentError(error.message);
    }
  }
  
  // –ü–æ–ª—É—á–∞–µ–º email –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–ø–ª–∞—Ç—ã
  function getAutoPaymentEmail() {
    try {
      // –°–ø–æ—Å–æ–± 1: –ò–∑ localStorage (—Å–æ—Ö—Ä–∞–Ω–µ–Ω –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã)
      const savedEmail = localStorage.getItem('tilda_registration_email');
      if (savedEmail) {
        console.log('üì® Email –Ω–∞–π–¥–µ–Ω –≤ localStorage:', savedEmail);
        return savedEmail;
      }
  
      // –°–ø–æ—Å–æ–± 2: –ò–∑ –ø–æ–ª—è —Ñ–æ—Ä–º—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
      const emailField = document.querySelector('input[type="email"], input[name*="email"]');
      if (emailField && emailField.value) {
        console.log('üì® Email –Ω–∞–π–¥–µ–Ω –≤ –ø–æ–ª–µ —Ñ–æ—Ä–º—ã:', emailField.value);
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è –±—É–¥—É—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        localStorage.setItem('tilda_registration_email', emailField.value);
        return emailField.value;
      }
  
      // –°–ø–æ—Å–æ–± 3: –ò–∑ URL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è)
      const urlParams = new URLSearchParams(window.location.search);
      const emailFromUrl = urlParams.get('email');
      if (emailFromUrl) {
        console.log('üì® Email –Ω–∞–π–¥–µ–Ω –≤ URL:', emailFromUrl);
        return emailFromUrl;
      }
  
      console.warn('‚ö†Ô∏è Email –Ω–µ –Ω–∞–π–¥–µ–Ω');
      return null;
  
    } catch (error) {
      console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ email:', error);
      return null;
    }
  }
  
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
  function showAutoPaymentError(message) {
    const errorElement = document.getElementById('auto-payment-error');
    const loadingElement = document.getElementById('auto-payment-loading');
    const manualElement = document.getElementById('manual-redirect');
    
    if (errorElement) {
      errorElement.textContent = message;
      errorElement.style.display = 'block';
    }
    
    if (loadingElement) {
      loadingElement.style.display = 'none';
    }
    
    if (manualElement) {
      manualElement.style.display = 'block';
      
      // –°–æ–∑–¥–∞–µ–º —Å—Å—ã–ª–∫—É –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–∏
      const paymentLink = document.getElementById('payment-link');
      if (paymentLink) {
        paymentLink.onclick = function(e) {
          e.preventDefault();
          window.location.reload();
        };
        paymentLink.textContent = 'üîÑ –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞';
      }
    }
  }
  
  // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ–ø–ª–∞—Ç—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø–æ–ø–∞–ø–∞
  document.addEventListener('DOMContentLoaded', function() {
    console.log('üéØ –ü–æ–ø–∞–ø –∑–∞–≥—Ä—É–∂–µ–Ω, –∑–∞–ø—É—Å–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–ø–ª–∞—Ç—ã...');
    
    // –î–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º
    setTimeout(() => {
      initAutoPayment();
    }, AUTO_PAYMENT_CONFIG.REDIRECT_DELAY);
  });
  
  // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ–ø–∞–ø–∞
  function startAutoPayment() {
    console.log('üéØ –ó–∞–ø—É—Å–∫ –æ–ø–ª–∞—Ç—ã –ø–æ –∫–æ–º–∞–Ω–¥–µ...');
    initAutoPayment();
  }
  
  // –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
  window.startAutoPayment = startAutoPayment;
  </script>